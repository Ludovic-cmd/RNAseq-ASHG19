---
title: "Untitled"
output: github_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Prerequisits 

To perform a full OUTRIDER analysis we can install the package from the Bioconductor 
repository with the following commands:

```{r}
if(!requireNamespace("OUTRIDER", quietly=TRUE)){
    if(!requireNamespace("BiocManager", quietly=TRUE)){
        install.packages("BiocManager")
    }
    BiocManager::install("OUTRIDER")
}
```

If you use an R version prio *3.5.0* please see the instruction on our [github page](https://github.com/gagneurlab/OUTRIDER)

## OUTRIDER: RNA-seq expression outlier detection

Quick guid through the detection and downstream analysis of expression outliers.

```{r cars}
library(OUTRIDER)
```

## Data used in this exercise


You can also embed plots, for example:

```{r pressure}

# full data set from Kremer et al.
URL <- paste0("https://media.nature.com/original/nature-assets/", 
        "ncomms/2017/170612/ncomms15824/extref/ncomms15824-s1.txt")
ctsTable <- read.table(URL, sep="\t")

# create OutriderDataSet object
ods <- OutriderDataSet(countData=ctsTable)

# filter out non expressed genes
ods <- filterExpression(ods, minCounts=TRUE, filterGenes=TRUE)

# run full OUTRIDER pipeline (control, fit model, calculate P-values)
ods <- OUTRIDER(ods)

# results (only significant)
res <- results(ods)
head(res)

# example of a Q-Q plot for the most significant outlier
plotQQ(ods, res[1, geneID])

# example of the expression rank plot for the most significant outlier
plotExpressionRank(ods, res[1, geneID])

```



## A quick tour

```{r}
# get data
ctsFile <- system.file('extdata', 'KremerNBaderSmall.tsv', 
        package='OUTRIDER')
ctsTable <- read.table(ctsFile, check.names=FALSE)
ods <- OutriderDataSet(countData=ctsTable)

# filter out non expressed genes
library(TxDb.Hsapiens.UCSC.hg19.knownGene)
library(org.Hs.eg.db)
txdb <- TxDb.Hsapiens.UCSC.hg19.knownGene
map <- select(org.Hs.eg.db, keys=keys(txdb, keytype = "GENEID"), 
        keytype="ENTREZID", columns=c("SYMBOL"))
ods <- filterExpression(ods, minCounts=TRUE, filterGenes=TRUE)

# run full OUTRIDER pipeline (control, fit model, calculate P-values)
ods <- OUTRIDER(ods)

# results (only significant)
res <- results(ods)
head(res)

# example of a Q-Q plot for the most significant outlier
plotQQ(ods, res[1, geneID])
```

